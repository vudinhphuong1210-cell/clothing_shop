CREATE Database clothing_shop;
Use clothing_shop;
CREATE TABLE Users (
    UserID INT IDENTITY(1,1) PRIMARY KEY,
    FullNameCustomer NVARCHAR(100),
    Phone VARCHAR(15),
    Point INT DEFAULT 0,
    UserName VARCHAR(50) UNIQUE NOT NULL,
    PassWord VARCHAR(100) NOT NULL,
    Role VARCHAR(20) NOT NULL
);
CREATE TABLE Category (
    CategoryID INT IDENTITY(1,1) PRIMARY KEY,
    CategoryName NVARCHAR(100) NOT NULL
);
CREATE TABLE Product (
    ProductID INT IDENTITY(1,1) PRIMARY KEY,
    CategoryID INT,
    ProductName NVARCHAR(100),
    Price DECIMAL(10,2),
    Image NVARCHAR(255),
    Status NVARCHAR(50),
    Description NVARCHAR(MAX),

    CONSTRAINT FK_Product_Category
        FOREIGN KEY (CategoryID) REFERENCES Category(CategoryID)
);
CREATE TABLE ProductStats (
    ProductStatsID INT IDENTITY(1,1) PRIMARY KEY,
    ProductID INT,
    TotalSold INT DEFAULT 0,
    TotalInStock INT,
    LastUpdated DATETIME,
    Size NVARCHAR(10),
    Color NVARCHAR(30),

    CONSTRAINT FK_ProductStats_Product
        FOREIGN KEY (ProductID) REFERENCES Product(ProductID)
);
CREATE TABLE Orders (
    OrderID INT IDENTITY(1,1) PRIMARY KEY,
    UserID INT,
    OrderDate DATETIME,
    TotalAmount DECIMAL(10,2),
    OrderStatus NVARCHAR(50),
    Address NVARCHAR(255),

    CONSTRAINT FK_Orders_Users
        FOREIGN KEY (UserID) REFERENCES Users(UserID)
);
CREATE TABLE OrderDetail (
    OrderDetailID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT,
    ProductStatsID INT,
    Quantity INT,
    Price DECIMAL(10,2),

    CONSTRAINT FK_OrderDetail_Orders
        FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),

    CONSTRAINT FK_OrderDetail_ProductStats
        FOREIGN KEY (ProductStatsID) REFERENCES ProductStats(ProductStatsID)
);
CREATE TABLE Payment (
    PaymentID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT,
    PaymentMethod NVARCHAR(50),
    PaymentStatus NVARCHAR(50),
    PaymentDate DATETIME,

    CONSTRAINT FK_Payment_Orders
        FOREIGN KEY (OrderID) REFERENCES Orders(OrderID)
);
CREATE TABLE Shipping (
    ShippingID INT IDENTITY(1,1) PRIMARY KEY,
    OrderID INT,
    ShippingStatus NVARCHAR(50),
    ShippingDate DATETIME,

    CONSTRAINT FK_Shipping_Orders
        FOREIGN KEY (OrderID) REFERENCES Orders(OrderID)
);
